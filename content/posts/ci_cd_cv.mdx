---
slug: ci_cd_cv
title: Publicaci√≥n de cambios en CV a trav√©s de CI/CD
thumbnail: /images/ci_cd_cv_4.3.png
summary: Desencadenar el despliegue de cambios en el CV (LaTex) a trav√©s de
  procesos de CI/CD (Github Actions).
date: 2021-11-24
author: cdelgado
tags:
  - ci_cd
  - spanish
---
Hace ya un tiempo, me encontr√© enfrente de mi CV con la urgente necesidad de modificarlo para enviarlo a un proceso en el que lo requer√≠a. Era una tarea que odiaba (mucho) , y como consecuencia, mi CV solo se actualizaba bajo fuerza mayor.

En aquel momento, el documento estaba elaborado mediante cajitas de colores y bloques de texto en un documento de Word. No era consciente de los muchos problemas y quebraderos de cabeza que me daba este formato. Ahora, cuando pienso en ese endemoniado fichero, lo recuerdo con a√±oranza, pero os aseguro que nada en este mundo me har√≠a volver al docx. 

## Problemas que encontraba

Voy al grano: 

* El cambio m√°s temido era eliminar alg√∫n bloque para adaptar el contenido del CV. Esto supon√≠a pr√°cticamente rehacer el documento. 
* Viv√≠a con miedo a perder alguna versi√≥n del CV. Ten√≠a m√∫ltiples copias del documento, as√≠ como otras tantas en el disco duro externo. Muchas veces me encontr√© rehaci√©ndolo al no encontrar la versi√≥n m√°s actual, para encontrarla despu√©s de unos d√≠as en un fichero mal nombrado. 
* Eventualmente encontraba problemas con la gesti√≥n del layout del documento. Las cajas se descuadraban y ten√≠a que luchar con Word para alinearlas de nuevo. 

Seguro que podr√≠a listar m√°s problemas, pero no quiero seguir rememorando esos tiempo. Quiero contaros c√≥mo lo tengo montado ahora mismo. 

## CV Como C√≥digo

Continuando con la obsesi√≥n que tenemos los inform√°ticos de expresar todo como c√≥digo, decid√≠ pasarme a **LaTeX**. Ten√≠a mis dudas, pero *oooh boy....*

Tengo que aclarar que no soy ni mucho menos experto en este tema, pero estamos en pleno siglo XXI, e internet est√° lleno de recursos, y en este caso de plantillas. 

Utilizando LaTeX, puedo generar un fichero pdf que se puede visualizar en pr√°cticamente cualquier dispositivo. 

A√±adir o eliminar cualquier bloque se reduce a cambios en el c√≥digo fuente, ya que la distribuci√≥n del documento y la apariencia visual se define mediante c√≥digo. 

El documento se puede versionar f√°cilmente a trav√©s de **git**.

Todos los problemas se solucionan autom√°gicamente.

## Publicar el CV

Cuando mont√© este sitio web, ten√≠a claro que quer√≠a dejar un hueco para [mi CV](https://cdelgadoguiberteau.netlify.app/cv). El documento que se muestra en la p√°gina web, est√° incluido en el repositorio del c√≥digo de la misma, y se incrusta en la p√°gina que le corresponde al construir la aplicaci√≥n con **Nextjs**. Esto significa que para introducir alg√∫n cambio en el CV que se muestra en la p√°gina, es necesario actualizar el fichero del repositorio de la p√°gina web, y regenerarla. 

Por suerte, ya tengo montado el proceso de despliegue continuo de la p√°gina, por lo que eso no supondr√° ning√∫n problema. 

Los pasos que he tenido que preparar para llegar a la publicaci√≥n del CV en el sitio web son dos: 

1. Crear el repositorio del c√≥digo fuente y los recursos utilizados en el CV.
2. Crear la pipeline de CI/CD del fichero

Sencillo, ¬øverdad? :D

## Pipeline Github Actions

La Pipeline es muy sencilla, lleva a cabo cuatro pasos:

1. Checkout del c√≥digo.
2. Generaci√≥n del pdf.
3. Cambio de nombre del fichero pdf.
4. Publicaci√≥n del pdf en el repositorio de la p√°gina web.

Tras completar el paso cuatro, se dispara la generaci√≥n del sitio web. 

### Implementaci√≥n de la pipeline

A continuaci√≥n a√±ado el fragmento de la pipeline que contiene los pasos de la misma:

```yaml
    steps:
      - name: Set up Git repository
        uses: actions/checkout@v2
      - name: Compile LaTeX document
        uses: xu-cheng/latex-action@v2
        with:
          root_file: main.tex
      - name: Rename cv file
        run: |
          mv main.pdf CV_file.pdf
      - name: Pushes cv pdf file
        uses: dmnemec/copy_file_to_another_repo_action@main
        env:
          API_TOKEN_GITHUB: ${{ secrets.API_TOKEN_GITHUB }}
        with:
          source_file: 'CV_file.pdf'
          destination_repo: 'githubUser/github_repo'
          destination_branch: 'branchName'
          destination_folder: 'public'
          user_email: 'user_email@email.com'
          user_name: 'user_name'
          commit_message: 'ci: deployed from code repository'
```

* He cambiado los valores de las variables con datos gen√©ricos, por lo que para implementarlo de forma similar, habr√≠a que personalizar dichas variables.
* Para llevar a cabo el despliegue en otro repositorio, es necesario crear un token con los permisos de repo, y a√±adirla como secreto del repositorio donde se encuentra el c√≥digo del CV.

## Consideraciones

Bueno, la automagia tiene su precio. 

Si, cuando publico un cambio del CV, se dispara la pipeline de la p√°gina web. Es el precio a pagar por pre-generar todas las p√°ginas con Nextjs.  

Si, hay otras formas. Nextjs da la opci√≥n de renderizado en el lado del servidor alguna de las p√°ginas. Podr√≠amos disponibilizar el fichero pdf en alg√∫n otro lugar, y referenciarlo desde la p√°gina del CV.

Si, es posible que lo cambie en alg√∫n momento. No obstante, y dado que la capa gratuita de los servicios que utilizo son lo suficientemente generosas, a d√≠a de hoy no tengo dicha necesidad. 

## Conclusiones

La receta que explico en este post no se limita a publicar el fichero en una p√°gina web. Pensad las m√∫ltiples formas de las que pod√©is distribuir un fichero hoy en d√≠a, solo hay que darle un poco al coco. 

Seguro que el proceso no es todo lo optimo que podr√≠a llegar a ser. Estar√© encantado de escuchar cualquier sugerencia a trav√©s de cualquiera de los canales que publico en este sitio web, por lo que no dud√©is en poneros en contacto conmigo. 

Un saludo a todos, y muchas gracias por llegar hasta aqu√≠! üòÉ

## Recursos

* Introducci√≥n a Github Actions: <https://docs.github.com/en/actions/quickstart>
* Github Action for LaTeX: <https://github.com/marketplace/actions/github-action-for-latex>
* Github Action Push File: <https://github.com/marketplace/actions/push-a-file-to-another-repository>